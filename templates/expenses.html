{% extends "base.html" %} {% block title %}Expenses{% endblock %} {% block
content %}
<h2 class="mb-4">Expense Tracker</h2>

<div class="card bg-light mb-4">
  <div class="card-body">
    <h5 class="card-title">Add New Expense</h5>
    <form action="{{ url_for('expenses.list_expenses') }}" method="POST">
      <div class="row g-3">
        <div class="col-md-6">
          <label for="description" class="form-label">Description</label>
          <input type="text" name="description" class="form-control" required />
        </div>
        <div class="col-md-3">
          <label for="amount" class="form-label">Amount ($)</label>
          <input
            type="number"
            name="amount"
            class="form-control"
            step="0.01"
            min="0.01"
            required
          />
        </div>
        <div class="col-md-3">
          <label for="date" class="form-label">Date</label>
          <input
            type="date"
            name="date"
            class="form-control"
            value="{{ date.today().strftime('%Y-%m-%d') }}"
            required
          />
        </div>
        <div class="col-md-6">
          <label for="project_id" class="form-label">Link to Project</label>
          <select name="project_id" class="form-select" required>
            <option value="" disabled selected>Choose a project...</option>
            {% for project in projects %}
            <option value="{{ project.id }}">{{ project.title }}</option>
            {% endfor %}
          </select>
        </div>
        <div class="col-md-4">
          <label for="category_id" class="form-label">Category</label>
          <select name="category_id" class="form-select" required>
            <option value="" disabled selected>Choose a category...</option>
            {% for category in categories %}
            <option value="{{ category.id }}">{{ category.name }}</option>
            {% endfor %}
          </select>
        </div>
        <div class="col-md-2 d-flex align-items-end">
          <button type="submit" class="btn btn-primary w-100">
            Add Expense
          </button>
        </div>
      </div>
    </form>
  </div>
</div>

<div class="card">
  <div class="card-header">
    <h5>All Expenses</h5>
  </div>
  <div class="card-body">
    <table class="table table-hover">
      <thead>
        <tr>
          <th>Date</th>
          <th>Description</th>
          <th>Project</th>
          <th>Category</th>
          <th class="text-end">Amount</th>
          <th></th>
        </tr>
      </thead>
      <tbody>
        {% for expense in expenses %}
        <tr>
          <td>{{ expense.date.strftime('%Y-%m-%d') }}</td>
          <td>{{ expense.description }}</td>
          <td>{{ expense.project.title }}</td>
          <td>
            <span class="badge bg-secondary">{{ expense.category.name }}</span>
          </td>
          <td class="text-end">${{ "%.2f"|format(expense.amount) }}</td>
          <td class="text-end">
            <form
              action="{{ url_for('expenses.delete_expense', expense_id=expense.id) }}"
              method="POST"
              onsubmit="return confirm('Are you sure you want to delete this expense?');"
            >
              <button type="submit" class="btn btn-sm btn-outline-danger">
                Delete
              </button>
            </form>
          </td>
        </tr>
        {% else %}
        <tr>
          <td colspan="6" class="text-center fst-italic">
            No expenses logged yet.
          </td>
        </tr>
        {% endfor %}
      </tbody>
    </table>
  </div>
</div>
{% endblock %}
